# Hierarchical-maturation-WM-connectomes-0-to-8-yrs

   This repository provides core code and relevant toolboxes for data analysis in the manuscript "Hierarchical maturation of structural brain connectomes from birth to childhood"

   ## Overview:
Contents include standalone software, source code, and demo data. All data necessary to reproduce our results have been made publicly available, including structural connectivity (SC) matrices, graph theoretical metrics, regional dMRI microstructural indexes, brain parcellations, anonymized demographic information, intermediate results during the analysis, and data for visualizing the figures. All data are available in Release.
  
   ## Installation guide:

   All the scripts (*.m files in the code folder) and the toolboxes can be executed by adding the appropriate environment paths according to the corresponding code language. Use the "add path" function for Matlab, the "pip install" function for Python, and the "install.packages()" function for R. These procedures are not time-consuming.
   For results visualization on brain surface, a open source toolbox (BrainNet Viewer, https://www.nitrc.org/projects/bnv) should be also included in the environment paths.

   ## Code:

   The following analyses were carried out using open source packages:

   1. **Group SC generation**: The group-level connectome backbone was generated by using a consensus approach that preserves the connection length distributions of individual networks (https://www.brainnetworkslab.com/coderesources) [1].
   2. **Spin test**: The spin test was conducted using an open Matlab code package (https://github.com/frantisekvasa/rotate_parcellation) [2].
   3. **Support vector regression (SVR) model**: The nodal efficiency at 8 y were predicted using an SVR model with nodal growth rates at each age point as input features. This analysis was performed using an open Matlab code package (https://github.com/ZaixuCui/Pattern_Regression_Clean/tree/master/SVR) [3] and LIBSVM Matlab toolbox (https://www.csie.ntu.edu.tw/~cjlin/libsvm/).
   4. **Generalized additive models (GAM)**: The generalized additive models were performed using the R package mgcv (https://cran.r-project.org/web/packages/mgcv/index.html).
   5. **Graph theoretical analysis**: The global and regional topological metrics were calculated using the Gretna software (https://www.nitrc.org/projects/gretna/) [4].
   6. **Multilayer-module analysis**:  The multilayer module detection on matrixes across age-subgroups was conducted using an open Matlab code package (https://github.com/GenLouvain/GenLouvain/) [5].
   6. **Neuron-maps**：The association analysis between nodal topography maturation (growth rates of nodal efficiency and module flexibility) and cortical neurobiological hierarchies was conducted using an open python code package (https://github.com/netneurolab/neuromaps) [6].
   7. **Mediation analysis** The mediation effect of local microstructural indexes on the relationship between nodal growth rates at infancy and later nodal efficiency was performed using an open Matlab code package (https://github.com/canlab/MediationToolbox/tree/master/mediation_toolbox) [7].
   8. **Visualization**: The plots on brain surface were drawn by BrainNet Viewer (https://www.nitrc.org/projects/bnv) [8].

   The main analyses were carried out step-by-step using the source code as follows.

   1. **set working paths and prior variates**: Step1_load_files.m

   2. **Age-related curve fitting analyses for global network topography attributes**: Step2_global_metrics.m 

   3. **Age-related curve fitting analyses, between cortical classes analyses, and prediction models for nodal efficiency**: Step3_nodal_efficiency_slopes.m

   4. **Sliding window analyses and clustering analyses for hubs and modules**: Step4_nodal_hubs_mudules

   5. **Neuron-maps analyses between nodal topography maturation and cortical neurobiological hierarchies**: Step5_neuromaps.m

   6. **The mediation analyses of local microstructural indexes on the relationship between nodal growth rates and nodal efficiency**: Step6_nodal_micro_mediation

Custom code and toolboxes were tested on a 64-bit Windows 11 PC (Intel Core i9-12900K 64 RAM). Data analysis was performed using Matlab 2020b, Python 3.7.0, and R 4.0.3. We thank the authors and developers for providing these data analysis tools.

   ## Data：
   All data（Subset 1 and Subset 2）are available in Releases (https://github.com/tengdazhao/Hierarchical-maturation-WM-connectomes-0-to-8-yrs).
   
   We provided **individual WM networks, graph-theoretical attributes, regional microstructural indexes** for all scans of 0 to 8 yrs at the highest node resolution (500 nodes).

   1.	**Data\Atlas**: basic information of brain parcellation including spatial coordinates (500atlas.xlsx), NIFTI pars (500parcellation.nii), surface for plots and mapping (BrainMesh_ICBM152_smoothed.nv,Par_500_fslr-lh.gii, Par_500_fslr-rh.gii), and cortical classes (Her3name.mat).
   2.	**Data\Cov**: demographic information and brain size for each individual (Age_gender_brainsize.mat)
   3.	**Data\Gretna_results**: all global and regional network topological attributes for each individual network (*.mat)
   4.	**Data\Micro**: individual regional microstructural indexes of connected WM tracts (*.mat)
   5.	**Data\Network**: individual WM networks (Matrixallpar500FN.mat:same order as Age_gender_brainsize.mat, Matrixallpar500FNsortage.mat: age order for sliding windows) and module assignments of multilayer module analyses for age-subgroup sliding windows(Multilayer_modules_norm_100.mat, which is quite time consuming).

   Finally, some supporting data for visualization (option files for BrainNet Viewer) can be found in Code\opt.


   ## References
   1.	R. F. Betzel, A. Griffa, P. Hagmann, B. Mišić, Distance-dependent consensus thresholds for generating group-representative structural brain networks. Network neuroscience 3, 475-496 (2019).
   2.	A. F. Alexander-Bloch et al., On testing for spatial correspondence between maps of human brain structure and function. Neuroimage 178, 540-551 (2018).
   3.	Z. Cui, G. Gong, The effect of machine learning regression algorithms and sample size on individualized behavioral prediction with functional connectivity features. Neuroimage 178, 622-637 (2018).
   4.	J. Wang et al., GRETNA: a graph theoretical network analysis toolbox for imaging connectomics. Frontiers in human neuroscience 9, 386 (2015).
   5.	M. Kivelä et al., Multilayer networks. Journal of complex networks 2, 203-271 (2014)
   6.	R. D. Markello et al., neuromaps: structural and functional interpretation of brain maps. Nat. Methods 19, 1472-1479 (2022).
   7.	Shrout PE, Bolger N, Mediation in experimental and nonexperimental studies: New procedures and recommendations. Psychol Methods 7:422–445 (2002).
   8.	M. Xia, J. Wang, Y. He, BrainNet Viewer: a network visualization tool for human brain connectomics. PloS one 8, e68910 (2013).


